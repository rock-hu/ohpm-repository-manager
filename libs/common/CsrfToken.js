"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CsrfToken=void 0;const e=require("../utils/RandomUtil"),t=require("./RepoResponse"),s=require("../packages/config/config");class o{static token(t){const n=e.RandomUtil.generateRandomSecretKey();t.set(o.CSRF_TOKEN_HEADER_KEY,n),t.cookie(o.CSRF_TOKEN_COOKIE_KEY,n,{path:"/",sameSite:"strict",secure:"https"===s.config.listen.proto})}static gen(e,t,s){o.token(t),s()}static validate(e,s,n){const i=e.cookies[o.CSRF_TOKEN_COOKIE_KEY],r=e.headers[o.CSRF_TOKEN_HEADER_KEY];null!==i&&null!==r&&i===r?n():t.RepoResponse.denied(s)}}exports.CsrfToken=o,o.CSRF_TOKEN_COOKIE_KEY="_csrf",o.CSRF_TOKEN_HEADER_KEY="x-csrf-token";