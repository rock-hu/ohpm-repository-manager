"use strict";var e=this&&this.__awaiter||function(e,n,t,o){return new(t||(t=Promise))((function(i,r){function s(e){try{d(o.next(e))}catch(e){r(e)}}function c(e){try{d(o.throw(e))}catch(e){r(e)}}function d(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,c)}d((o=o.apply(e,n||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.deployedInstanceService=exports.DeployedInstanceService=void 0;const n=require("./DeployedInstanceRepository"),t=require("../../entity/DeployedInstance"),o=require("../../utils/PageUtil");class i{addDeployedInstance(o,i,r,s,c){return e(this,void 0,void 0,(function*(){const e=yield n.deployedInstanceRepository.findDeployedInstanceByKey(o,i);if(e&&e.recordList[0]){const t=e.recordList[0];t.version=r,yield n.deployedInstanceRepository.update(t)}else{const e=new t.DeployedInstance({machine:o,port:i,version:r,cryptoVersion:s,newCryptoVersion:c});yield n.deployedInstanceRepository.insert(e)}}))}getDeployedInstanceList(t=1,i=o.MAX_PAGE_SIZE){return e(this,void 0,void 0,(function*(){return n.deployedInstanceRepository.findByFilter(t,i)}))}removeDeployedInstance(t="machine",o){return e(this,void 0,void 0,(function*(){return n.deployedInstanceRepository.deleteByKey(t,o)}))}}exports.DeployedInstanceService=i,exports.deployedInstanceService=new i;