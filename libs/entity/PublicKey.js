"use strict";var e=this&&this.__decorate||function(e,t,r,i){var o,n=arguments.length,l=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(l=(n<3?o(l):n>3?o(t,r,l):o(t,r))||l);return n>3&&l&&Object.defineProperty(t,r,l),l},t=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.PublicKey=exports.PKNamePattern=void 0;const r=require("../utils/RandomUtil"),i=require("../common/CommonValidator"),o=require("./User"),n=require("../common/RepoError"),l=require("../common"),a=require("typeorm");exports.PKNamePattern=/^[\u4e00-\u9fa5\a-zA-Z0-9-_/@]|[a-zA-Z0-9-_/@]{0,50}$/;let p=class{constructor(e,t){e&&t&&(this.id=r.RandomUtil.generateUUID(),this.userId=t.id,this.name=e.name,this.publicKey=e.publicKey,this.publishId=t.publishId,this.publishPassword=e.publishPassword,this.cryptoVersion=e.cryptoVersion,this.createTime=(new Date).getTime(),this.checkAllFields())}checkAllFields(){if(i.CommonValidator.checkStringWithRegex(exports.PKNamePattern,"publicKey.name",this.name),!this.publicKey||this.publicKey.length>8192)throw new n.RepoClientError(l.ErrorCode.PublicKeyContentError,"The public_key field cannot contain more than 8192 characters.")}};e([(0,a.PrimaryColumn)({type:"varchar",length:128}),t("design:type",String)],p.prototype,"id",void 0),e([(0,a.Column)({type:"varchar",length:50}),t("design:type",String)],p.prototype,"name",void 0),e([(0,a.Column)({type:"bigint"}),t("design:type",Number)],p.prototype,"createTime",void 0),e([(0,a.Column)({type:"varchar",length:8192}),t("design:type",String)],p.prototype,"publicKey",void 0),e([(0,a.Column)({type:"varchar",length:64,nullable:!0}),t("design:type",String)],p.prototype,"publishId",void 0),e([(0,a.Column)({type:"varchar",length:2048,nullable:!0}),t("design:type",String)],p.prototype,"publishPassword",void 0),e([(0,a.Column)({type:"varchar",length:64,nullable:!0}),t("design:type",String)],p.prototype,"cryptoVersion",void 0),e([(0,a.Column)({type:"varchar",length:64}),t("design:type",String)],p.prototype,"userId",void 0),p=e([(0,a.Entity)("publickey"),t("design:paramtypes",[Object,o.User])],p),exports.PublicKey=p;