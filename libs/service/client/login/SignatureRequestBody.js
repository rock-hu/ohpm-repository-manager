"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SignatureRequestBody=void 0;const t=require("../../../common/CommonValidator");class e{constructor(e){t.CommonValidator.checkNotNullStringType(e.version,"version"),t.CommonValidator.checkNotNullStringType(e.publishId,"publishId"),t.CommonValidator.checkNotNullNumberType(e.timestamp,"timestamp"),t.CommonValidator.checkNotNullStringType(e.nonce,"nonce"),t.CommonValidator.checkNotNullStringType(e.signature,"signature"),this.version=e.version,this.publishId=e.publishId,this.timestamp=e.timestamp,this.nonce=e.nonce,this.signature=e.signature,this.checkAllFields()}getVersion(){return this.version}getPublishId(){return this.publishId}getTimestamp(){return this.timestamp}getNonce(){return this.nonce}getSignature(){return this.signature}checkAllFields(){t.CommonValidator.verifyTimestamp(this.timestamp),t.CommonValidator.verifyVersion(this.version),t.CommonValidator.checkStringWithRegex(e.PUBLISH_ID_REGEX,"publishId",this.publishId),t.CommonValidator.checkStringWithRegex(e.NONCE_REGEX,"nonce",this.nonce),t.CommonValidator.checkStringWithRegex(e.SIGNATURE_REGEX,"signature",this.signature)}}exports.SignatureRequestBody=e,e.PUBLISH_ID_REGEX=/^[0-9A-Z]{10}$/,e.NONCE_REGEX=/^[0-9A-Za-z]{32}$/,e.SIGNATURE_REGEX=/^.{512,1024}$/;