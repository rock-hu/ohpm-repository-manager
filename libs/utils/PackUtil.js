"use strict";var e=this&&this.__awaiter||function(e,i,t,r){return new(t||(t=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function l(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var i;e.done?n(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(o,l)}c((r=r.apply(e,i||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.extract=exports.checkFile=exports.readFiles=void 0;const t=i(require("path")),r=i(require("jszip")),n=i(require("fs")),s=require("./FsUtil");exports.readFiles=function i(r,n,o){return e(this,void 0,void 0,(function*(){const e=yield s.FsUtil.readdir(r,{withFileTypes:!0});for(const l of e){const e=t.default.join(r,l.name);l.isFile()?n.file(o(e),yield s.FsUtil.readFile(e),{unixPermissions:400}):yield i(e,n,o)}}))},exports.checkFile=function(i,t){return e(this,void 0,void 0,(function*(){const e=new r.default,n=yield s.FsUtil.readFile(i),o=yield e.loadAsync(n),l=Object.keys(o.files);return t(l)}))},exports.extract=function(i,o,l){return e(this,void 0,void 0,(function*(){const e=new r.default,c=yield s.FsUtil.readFile(i),d=yield e.loadAsync(c),u=Object.keys(d.files),f=yield l(u);for(const e of f){const i=d.files[e],r=o(e,i).replace(/(\/|\\)/g,t.default.sep);i.dir?yield s.FsUtil.createDirIfNotExists(r):(yield n.default.promises.mkdir(t.default.dirname(r),{recursive:!0}),yield s.FsUtil.writeFile(r,Buffer.from(yield i.async("arraybuffer"))))}}))};