"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.localDependenciesValidate=exports.isInnerPkgDependency=exports.isLocalDependency=void 0;const t=require("./CustomValidateError"),n=e(require("semver")),r=/^(?:(\.\/)|(\.\\)|(file:\.\/)|(file:\.\\)|(\/)|(\\)|(file:\/)|(file:\\))/i,i="win32"===process.platform?/^(?:[.]|~\/|[/\\]|[a-zA-Z]:)/:/^(?:[.]|~\/|\/|[a-zA-Z]:)/,s=/^[a-z]/i,o=/^file:/i;function c(e){return"latest"!==(e=e||"")&&!n.default.validRange(e,{loose:!0,includePrerelease:!0})&&(!function(e){try{return new URL(e),!0}catch(e){return!1}}(e)||!(!e||!i.test(e)&&!o.test(e)))}function l(e){return e=e||"",r.test(e)||function(e){const t=e.replace("file:","");return s.test(t)&&!t.includes(":")}(e)}exports.isLocalDependency=c,exports.isInnerPkgDependency=l,exports.localDependenciesValidate=function(e){if(!e||"object"!=typeof e)return;const n=Object.keys(e);for(let r=0;r<n.length;r++){const i=e[n[r]];if(c(i)&&!l(i))throw new t.CustomValidateError(`${n}\`s spec "${i}" is a inner pkg dependency`,`本地引入的"${n}: "${i}" 依赖并不存在于上传har包内部`)}};