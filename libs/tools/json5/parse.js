"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parse=void 0;const e=require("./utils"),r={Null:"null".slice(1),True:"true".slice(1),False:"false".slice(1),Infinity:"Infinity".slice(1),NaN:"NaN".slice(1)};let t,i,n,o,u,f,a,l,s,d,c,m,p,v;function b(){for(d="default",c="",m=!1,p=1;;){v=h();const e=g[d]();if(null!=e)return e}}function h(){if(void 0!==t[o])return String.fromCodePoint(t.codePointAt(o))}function y(){const e=h();return null==e?f++:(o+=e.length,"\n"===e?(u++,f=0):f+=e.length),e}const g={default(){if(!(0,e.isSpaceSeparator)(v))return"/"===v?(y(),void(d="comment")):void 0===v?(y(),N("eof")):g[i]();y()},comment(){if("*"===v)return y(),void(d="multilineComment");if("/"===v)return y(),void(d="singleLineComment");throw S(y())},multilineComment(){if("*"===v)return y(),void(d="multilineCommentEnd");if(void 0===v)throw S(y());y()},multilineCommentEnd(){if("*"!==v){if("/"===v)return y(),void(d="default");if(void 0===v)throw S(y());y(),d="multilineComment"}else y()},singleLineComment:()=>["\n","\r","\u2028","\u2029"].includes(v)?(y(),void(d="default")):void 0===v?(y(),N("eof")):void y(),value(){if("{"===v||"["===v)return N("punctuator",y());if("n"===v)return y(),P(r.Null),N("null",null);if("t"===v)return y(),P(r.True),N("boolean",!0);if("f"===v)return y(),P(r.False),N("boolean",!1);if("-"===v||"+"===v)return"-"===y()&&(p=-1),void(d="sign");if([".","I","N"].includes(v)||(0,e.isDigit)(v))return w();if('"'===v||"'"===v)return m='"'===y(),c="",void(d="string");throw S(y())},identifierNameStartEscape(){if("u"!==v)throw S(y());y();const r=E();if("$"===r||"_"===r);else if(!(0,e.isIdStartChar)(r))throw V();c+=r,d="identifierName"},identifierName(){if(["$","_","‌","‍"].includes(v))c+=y();else{if("\\"===v)return y(),void(d="identifierNameEscape");if(!(0,e.isIdContinueChar)(v))return N("identifier",c);c+=y()}},identifierNameEscape(){if("u"!==v)throw S(y());y();const r=E();if(["$","_","‌","‍"].includes(r));else if(!(0,e.isIdContinueChar)(r))throw V();c+=r,d="identifierName"},sign(){if([".","I","N"].includes(v)||(0,e.isDigit)(v))return w();throw S(y())},zero:()=>"."===v?(c+=y(),void(d="numberPoint")):"e"===v||"E"===v?(c+=y(),void(d="numberExponent")):"x"===v||"X"===v?(c+=y(),void(d="hexNumber")):N("numeric",0*p),numberInt:()=>"."===v?(c+=y(),void(d="numberPoint")):"e"===v||"E"===v||(0,e.isDigit)(v)?void x():N("numeric",p*Number(c)),numberPointLeading(){if((0,e.isDigit)(v))return c+=y(),void(d="numberFraction");throw S(y())},numberPoint:()=>"e"===v||"E"===v?(c+=y(),void(d="numberExponent")):(0,e.isDigit)(v)?(c+=y(),void(d="numberFraction")):N("numeric",p*Number(c)),numberFraction(){if("e"!==v&&"E"!==v&&!(0,e.isDigit)(v))return N("numeric",p*Number(c));x()},numberExponent(){if("+"===v||"-"===v)return c+=y(),void(d="numberExponentSign");if((0,e.isDigit)(v))return c+=y(),void(d="numberExponentInt");throw S(y())},numberExponentSign(){if((0,e.isDigit)(v))return c+=y(),void(d="numberExponentInt");throw S(y())},numberExponentInt(){if(!(0,e.isDigit)(v))return N("numeric",p*Number(c));c+=y()},hexNumber(){if((0,e.isHexDigit)(v))return c+=y(),void(d="hexNumberInt");throw S(y())},hexNumberInt(){if(!(0,e.isHexDigit)(v))return N("numeric",p*Number(c));c+=y()},string(){if("\\"===v)return y(),void(c+=function(){const r=h();if("b"===r)return y(),"\b";if("f"===r)return y(),"\f";if("n"===r)return y(),"\n";if("r"===r)return y(),"\r";if("t"===r)return y(),"\t";if("v"===r)return y(),"\v";if("0"===r){if(y(),(0,e.isDigit)(h()))throw S(y());return"\0"}if("x"===r)return y(),function(){let r="",t=h();if(!(0,e.isHexDigit)(t))throw S(y());if(r+=y(),t=h(),!(0,e.isHexDigit)(t))throw S(y());return r+=y(),String.fromCodePoint(parseInt(r,16))}();if("u"===r)return y(),E();if(["\n","\u2028","\u2029"].includes(r))return y(),"";if("\r"===r)return y(),"\n"===h()&&y(),"";if((0,e.isDigit)(r))throw S(y());if(void 0===r)throw S(y());return y()}());if('"'===v)return m?(y(),N("string",c)):void(c+=y());if("'"===v)return m?void(c+=y()):(y(),N("string",c));if(["\n","\r",void 0].includes(v))throw S(y());c+=y()},start(){if("{"===v||"["===v)return N("punctuator",y());d="value"},beforePropertyName(){if("$"===v||"_"===v)return c=y(),void(d="identifierName");if("\\"===v)return y(),void(d="identifierNameStartEscape");if("}"===v)return N("punctuator",y());if('"'===v||"'"===v)return m='"'===y(),void(d="string");if((0,e.isIdStartChar)(v))return c+=y(),void(d="identifierName");throw S(y())},afterPropertyName(){if(":"===v)return N("punctuator",y());throw S(y())},beforePropertyValue(){d="value"},afterPropertyValue(){if(","===v||"}"===v)return N("punctuator",y());throw S(y())},beforeArrayValue(){if("]"===v)return N("punctuator",y());d="value"},afterArrayValue(){if(","===v||"]"===v)return N("punctuator",y());throw S(y())},end(){throw S(y())}};function N(e,r){return{type:e,value:r,line:u,column:f}}function w(){return"."===v?(c=y(),void(d="numberPointLeading")):"0"===v?(c=y(),void(d="zero")):(0,e.isDigit)(v)?(c=y(),void(d="numberInt")):"I"===v?(y(),P(r.Infinity),N("numeric",p*(1/0))):"N"===v?(y(),P(r.NaN),N("numeric",NaN)):void 0}function x(){"e"===v||"E"===v?(c+=y(),d="numberExponent"):(0,e.isDigit)(v)&&(c+=y())}function P(e){for(const r of e){if(h()!==r)throw S(y());y()}}function E(){let r="",t=4;for(;t-- >0;){const t=h();if(!(0,e.isHexDigit)(t))throw S(y());r+=y()}return String.fromCodePoint(parseInt(r,16))}const I={start(){const{type:e}=a;if("eof"===e)throw C();A()},beforePropertyName(){const{type:e,value:r}=a;if("identifier"===e||"string"===e)l=r,i="afterPropertyName";else if("punctuator"===e)D();else if("eof"===e)throw C()},afterPropertyName(){const{type:e}=a;if("eof"===e)throw C();i="beforePropertyValue"},beforePropertyValue(){const{type:e}=a;if("eof"===e)throw C();A()},beforeArrayValue(){const{type:e,value:r}=a;if("eof"===e)throw C();"punctuator"!==e||"]"!==r?A():D()},afterPropertyValue(){const{type:e,value:r}=a;if("eof"===e)throw C();","===r?i="beforePropertyName":"}"===r&&D()},afterArrayValue(){const{type:e,value:r}=a;if("eof"===e)throw C();","===r?i="beforeArrayValue":"]"===r&&D()},end(){}};function A(){let e;const{type:r,value:t}=a;if("punctuator"===r?"{"===t?e={}:"["===t&&(e=[]):["null","boolean","numeric","string"].includes(r)&&(e=t),void 0===s)s=e;else{const r=n[n.length-1];Array.isArray(r)?r.push(e):Object.defineProperty(r,l,{value:e,writable:!0,enumerable:!0,configurable:!0})}if(null!==e&&"object"==typeof e)n.push(e),i=Array.isArray(e)?"beforeArrayValue":"beforePropertyName";else{const e=n[n.length-1];i=null==e?"end":Array.isArray(e)?"afterArrayValue":"afterPropertyValue"}}function D(){n.pop();const e=n[n.length-1];i=null==e?"end":Array.isArray(e)?"afterArrayValue":"afterPropertyValue"}function S(r){return $(void 0===r?`JSON5: invalid end of input at ${u}:${f}`:`JSON5: invalid character '${function(r){if(void 0!==e.replacements[r])return e.replacements[r];if(r<" "){const e=r.charCodeAt(0).toString(16);return`\\x${`00${e}`.substring(e.length)}`}return r}(r)}' at ${u}:${f}`)}function C(){return $(`JSON5: invalid end of input at ${u}:${f}`)}function V(){return f-=5,$(`JSON5: invalid identifier character at ${u}:${f}`)}function $(e){const r=new SyntaxError(e);return r.lineNumber=u,r.columnNumber=f,r}exports.parse=function(e){t=String(e),i="start",n=[],o=0,u=1,f=0,a=void 0,l=void 0,s=void 0,v=void 0;do{a=b(),I[i]()}while("eof"!==a.type);return s};