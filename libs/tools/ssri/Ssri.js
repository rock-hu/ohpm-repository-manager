"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ssri=void 0;const e=require("./SsriOption"),r=require("./IntegrityMap"),s=require("./Integrity"),i=t(require("crypto"));exports.ssri=new class{parse(t,e){return new s.Integrity(t,e)}fromData(t,i){const n=(i=e.Opts.mergeWithDefaultOpts(i)).algorithms,o=e.Opts.getOptString(i.options);return n.reduce(((e,r)=>{const n=this.createDigest(r,t),u=new s.Integrity(`${r}-${n}${o}`,i);if(u.getAlgorithm()&&u.getDigest()){const t=u.getAlgorithm();e.put(t,u)}return e}),new r.IntegrityMap)}createDigest(t,e){return i.default.createHash(t).update(e).digest("base64")}};