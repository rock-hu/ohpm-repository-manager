"use strict";var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function a(e){try{i(r.next(e))}catch(e){c(e)}}function s(e){try{i(r.throw(e))}catch(e){c(e)}}function i(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}i((r=r.apply(e,t||[])).next())}))},t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.calculateHashAndKeepContent=void 0;const n=require("stream"),r=t(require("crypto"));exports.calculateHashAndKeepContent=function(t,o){return e(this,void 0,void 0,(function*(){const e=r.default.createHash(o),c=new n.PassThrough;let a;t.on("data",(t=>{e.update(t),c.write(t)})),t.once("end",(()=>{a=`${o}-${e.digest("base64")}`,e.destroy(),c.end()}));const s=t=>{throw c.destroy(t),e.destroy(t),t};return t.once("error",s),e.once("error",s),c.once("error",s),new Promise(((e,n)=>{t.once("end",(()=>{e({hash:a,contentStream:c})}))}))}))};