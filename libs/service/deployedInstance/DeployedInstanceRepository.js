"use strict";var e=this&&this.__awaiter||function(e,r,t,o){return new(t||(t=Promise))((function(n,i){function c(e){try{s(o.next(e))}catch(e){i(e)}}function d(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(c,d)}s((o=o.apply(e,r||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.deployedInstanceRepository=void 0;const r=require("../../common/DbFactory"),t=require("../../common/RepoError"),o=require("../../common");exports.deployedInstanceRepository=new class{constructor(){this.TABLE_NAME="deployedInstance"}insert(n){return e(this,void 0,void 0,(function*(){try{return r.commonDB.insertOne(this.TABLE_NAME,n,!0)}catch(e){throw new t.RepoServerError(o.ErrorCode.SaveDeployedInstanceError,"Fail to insert deployedInstance!",e)}}))}deleteByKey(n,i){return e(this,void 0,void 0,(function*(){try{return r.commonDB.deleteByKey(this.TABLE_NAME,i,n)}catch(e){throw new t.RepoServerError(o.ErrorCode.DeleteDeployedInstanceError,"Fail to delete deployedInstance!",e)}}))}update(n){return e(this,void 0,void 0,(function*(){try{return r.commonDB.upsertOne(this.TABLE_NAME,n,!0)}catch(e){throw new t.RepoServerError(o.ErrorCode.UpdateDeployedInstanceError,"Fail to update deployedInstance!",e)}}))}findDeployedInstanceByKey(n,i){return e(this,void 0,void 0,(function*(){try{return r.commonDB.findByFilter(this.TABLE_NAME,{filter:{machine:n,port:i}})}catch(e){throw new t.RepoServerError(o.ErrorCode.FindDeployedInstanceError,"Fail to find deployedInstance!",e)}}))}findByFilter(n,i,c){return e(this,void 0,void 0,(function*(){try{return r.commonDB.findByFilter(this.TABLE_NAME,{filter:c,pageQuery:{pageNum:n,pageSize:i}})}catch(e){throw new t.RepoServerError(o.ErrorCode.FindDeployedInstanceListError,"Fail to get deployedInstanceList!",e)}}))}};