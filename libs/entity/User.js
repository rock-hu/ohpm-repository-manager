"use strict";var e=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},t=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.User=exports.pwdPattern=exports.namePattern=void 0;const r=require("../common"),o=require("../utils/RandomUtil"),n=require("../common/RepoError"),i=require("typeorm"),s=require("../packages/definitions/types");exports.namePattern=/^[a-zA-Z][a-zA-Z0-9_]{0,29}$/,exports.pwdPattern=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[._!@#$%^&*\-+~?<>:])[A-Za-z\d._!@#$%^&*\-+~?<>:]{8,20}$/;let a=class{constructor(e){this.role=s.RoleType.Member,this.needChangePassword=!0,e&&(this.id=o.RandomUtil.generateUUID(),this.name=e.name,this.password=e.password,this.salt=o.RandomUtil.generateSecureRandomString(16),this.publishId=o.RandomUtil.generateSecureRandomString(5),this.createTime=(new Date).getTime(),this.checkAllFields())}checkAllFields(){if(!exports.namePattern.test(this.name))throw new n.RepoClientError(r.ErrorCode.UserNameError,"A string of up to 30 case-sensitive characters, including letters, digits, and underscores (_). It must start with a letter.");if(!exports.pwdPattern.test(this.password))throw new n.RepoClientError(r.ErrorCode.UserPassWordError,"The value must contain at least eight characters, including uppercase letters, lowercase letters, digits, and special characters.");if(![!0,!1].includes(this.needChangePassword))throw new n.RepoClientError(r.ErrorCode.UserChangePassWordError,"UserChangePassword validate fail")}};e([(0,i.PrimaryColumn)({type:"varchar",length:64}),t("design:type",String)],a.prototype,"id",void 0),e([(0,i.Column)({type:"varchar",length:32}),t("design:type",String)],a.prototype,"name",void 0),e([(0,i.Column)({type:"varchar",length:256}),t("design:type",String)],a.prototype,"password",void 0),e([(0,i.Column)({type:"varchar",length:64}),t("design:type",String)],a.prototype,"salt",void 0),e([(0,i.Column)({type:"tinyint"}),t("design:type",Number)],a.prototype,"role",void 0),e([(0,i.Column)({type:"varchar",length:64}),t("design:type",String)],a.prototype,"publishId",void 0),e([(0,i.Column)({type:"tinyint"}),t("design:type",Object)],a.prototype,"needChangePassword",void 0),e([(0,i.Column)({type:"bigint"}),t("design:type",Number)],a.prototype,"createTime",void 0),a=e([(0,i.Entity)("user"),t("design:paramtypes",[Object])],a),exports.User=a;