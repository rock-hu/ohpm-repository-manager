"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MapEntryRule=void 0;const e=require("../../../packages/log"),r=require("./types");exports.MapEntryRule=class{constructor(e,r,t){this.keyRule=e,this.valueRule=r,this.errorCallback=t}validate(t,a,o){o=o||a;const s=t.name;e.OhpmLazyLogger.debug(`start MapEntryRule.validate attribute "${o}" for package "${s}" in publishJson.`);const i=t[a];if(!i)return;const l=Object.keys(i),n={};try{for(const e of l)n.key=e,n.value=i[e],this.keyRule.validate({[e]:e},e),this.valueRule.validate(i,e)}catch(t){e.OhpmLazyLogger.error(`fail to validate "${o}" for package "${s}" in oh-package.json5: ${t}.`),this.errorCallback(o,{attrName:o,ruleType:r.ValidationRuleType.MapEntry,err:t,errorMsg:this.getErrorMsg(o,s,n),extInfo:{messageCN:this.getErrorMsgCN(o,s,n)}},s)}}getErrorMsg(e,r,t){return`attribute "${e}" for package "${r}" contains invalid kv pair: "${t.key}:${t.value}" in oh-package.json5.`}getErrorMsgCN(e,r,t){return`在包 "${r}" 的oh-package.json5文件中，字段 "${e}" 的值中存在非法键值对: "${t.key}:${t.value}"`}};