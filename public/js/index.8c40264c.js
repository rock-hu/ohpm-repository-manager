import{o as O}from"./ohpm.6d9b7dfa.js";import{z as v,_ as T,D as N,d as P}from"./index.83aebd5f.js";import{a as _}from"./element-plus.d9770c7f.js";import{t as C,h as A,e as G,_ as w,j as D,$ as L,ai as p,o as b,c as y,V as l,P as m,a as n,U as i,T as k,aq as M,Q as U,O as $,S as V,i as B}from"./@vue.405cd0f3.js";import{C as F}from"./ConfirmDialog.f3308ea3.js";import{B as z}from"./Button.59bb2c30.js";import{P as H}from"./Pagination.3cd17577.js";import"./axios.a3888612.js";import"./vue-i18n.b3f06251.js";import"./@intlify.54dd1442.js";import"./vue.44d375da.js";import"./marked.710fa320.js";import"./xss.e4f2f0a8.js";import"./clipboard.ce371577.js";import"./cssfilter.393cb597.js";import"./dayjs.f9ab3a77.js";import"./node-forge.4054bff5.js";import"./vue-router.779da2c0.js";import"./@element-plus.1b716427.js";import"./vuex.10212040.js";import"./highlight.js.504c3f6b.js";/* empty css                            */import"./lodash-es.2c2c875c.js";import"./@vueuse.1b628eaa.js";import"./@popperjs.c75af06c.js";import"./@ctrl.86a38320.js";import"./async-validator.bf8f818c.js";import"./memoize-one.297ddbcb.js";import"./normalize-wheel-es.54f5de6c.js";import"./@floating-ui.57eef0fc.js";import"./FooterButtons.71958792.js";const K=e=>v.get("/api/public-keys ").then(o=>o.data),Y=e=>v.post("/api/public-keys",e).then(o=>o.data),W=e=>v.delete(`/api/public-keys/${e.id}`).then(o=>o.data);const q=C({props:{visible:Boolean,afterUpdateOhpm:Function},setup(e,o){const s=A().appContext.config.globalProperties,f=G(null),r=w({ohpmModel:new O({})}),g={name:[{required:!0,message:s.$t("validator.titleIsNotNull"),trigger:"blur"},{min:1,max:50,message:s.$t("validator.title50Length"),trigger:"blur"},{required:!0,validator:N,trigger:"blur"}],publicKey:[{required:!0,message:s.$t("validator.keyIsNotNull"),trigger:"blur"}]},a=()=>{r.ohpmModel=new O({})},d=D(()=>e.visible),t=()=>{a(),o.emit("onClose")},u=c=>{const{name:h,publicKey:S}=r.ohpmModel;c.validate(R=>{R&&Y({name:h,publicKey:S}).then(I=>{I.code===200?(_.success(s.$t("ohpm.keyUpdateSuccess")),e.afterUpdateOhpm()):_.error(I.message)}).finally(()=>t())})};return{...L(r),rules:g,resetModel:a,handleClose:t,dialogVisible:d,formRef:f,saveOhpm:u}}}),E={class:"ohpm-add-dialog"},j={class:"dialog-title font-M h-24 lh-24"};function Q(e,o,s,f,r,g){const a=p("el-input"),d=p("el-form-item"),t=p("el-button"),u=p("el-form"),c=p("el-dialog");return b(),y("div",E,[l(c,{"close-on-click-modal":!1,modelValue:e.dialogVisible,"onUpdate:modelValue":o[4]||(o[4]=h=>e.dialogVisible=h),width:"640px","before-close":e.handleClose,"destroy-on-close":""},{header:m(()=>[n("div",j,i(e.$t("ohpm.addTitle")),1)]),default:m(()=>[l(u,{"label-position":"top",model:e.ohpmModel,rules:e.rules,ref:"formRef"},{default:m(()=>[l(d,{prop:"name"},{label:m(()=>[n("span",null,i(e.$t("ohpm.title")),1)]),default:m(()=>[l(a,{modelValue:e.ohpmModel.name,"onUpdate:modelValue":o[0]||(o[0]=h=>e.ohpmModel.name=h),placeholder:e.$t("ohpm.titlePlaceholder")},null,8,["modelValue","placeholder"])]),_:1}),l(d,{class:"formItem",label:e.$t("ohpm.key"),prop:"publicKey"},{default:m(()=>[l(a,{type:"textarea",rows:"5",modelValue:e.ohpmModel.publicKey,"onUpdate:modelValue":o[1]||(o[1]=h=>e.ohpmModel.publicKey=h),class:"form-input-textarea",placeholder:e.$t("ohpm.keyPlaceholder"),maxlength:"8192","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(d,null,{default:m(()=>[l(t,{class:"btnCancal",onClick:o[2]||(o[2]=h=>e.handleClose(e.formRef))},{default:m(()=>[k(i(e.$t("button.cancel")),1)]),_:1}),l(t,{class:"btnColor",onClick:o[3]||(o[3]=h=>e.saveOhpm(e.formRef))},{default:m(()=>[k(i(e.$t("button.save")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","before-close"])])}const J=T(q,[["render",Q],["__scopeId","data-v-532988dc"]]);const X=C({props:{ohpmList:Array,afterUpdateOhpm:Function,ohpmLoading:Boolean},components:{ConfirmDialog:F},setup(e){const o=A().appContext.config.globalProperties,s=w({headStyle:{background:"#F5F5F5",color:"#000000"},headRowStyle:{height:"40px"},dialogVisible:!1,confirmTitle:"",id:""}),f=t=>{s.id=t.id,s.confirmTitle=t.title,s.dialogVisible=!0},r=()=>{s.dialogVisible=!1},g=()=>{W({id:s.id}).then(t=>{t.code===200?(_.success(o.$t("ohpm.keyDeleteSuccess")),e.afterUpdateOhpm()):_.error(t.message)}).finally(()=>r())},a=t=>P(t,"YYYY-MM-DD hh:mm:ss"),d=D(()=>o.$t("tree.noData"));return{...L(s),noData:d,showConfirmDialog:f,handleClose:r,handleDeleteConfirm:g,timeFormat:a}}}),Z={class:"ohpm-table"},x=["onClick"];function ee(e,o,s,f,r,g){const a=p("el-table-column"),d=p("el-table"),t=p("ConfirmDialog"),u=M("loading");return b(),y("div",Z,[U((b(),$(d,{data:e.ohpmList,"header-cell-style":e.headStyle,"header-row-style":e.headRowStyle,"empty-text":e.noData},{default:m(()=>[l(a,{prop:"name","show-overflow-tooltip":"",label:e.$t("security.title")},null,8,["label"]),l(a,{prop:"publicKey","show-overflow-tooltip":"",label:e.$t("security.publicKey")},null,8,["label"]),l(a,{prop:"createTime","show-overflow-tooltip":"",label:e.$t("security.createTime")},{default:m(c=>[k(i(e.timeFormat(c.row.createTime)),1)]),_:1},8,["label"]),l(a,{fixed:"right","show-overflow-tooltip":"",label:e.$t("security.operate"),width:"100"},{default:m(c=>[n("span",{class:"pointer",onClick:h=>e.showConfirmDialog(c.row)},i(e.$t("notification.delete")),9,x)]),_:1},8,["label"])]),_:1},8,["data","header-cell-style","header-row-style","empty-text"])),[[u,e.ohpmLoading]]),l(t,{visible:e.dialogVisible,title:e.$t("notification.confirmTitle",{name:e.confirmTitle}),buttonStyle:!0,onOnClose:e.handleClose,onOnConfirm:e.handleDeleteConfirm},null,8,["visible","title","onOnClose","onOnConfirm"])])}const oe=T(X,[["render",ee],["__scopeId","data-v-fa0c8067"]]);const te=C({props:{ohpmList:Array,afterUpdateOhpm:Function,ohpmLoading:Boolean},components:{Button:z,OhpmItem:oe,OhpmAddDialog:J},setup(e){const o=w({showAddDialog:!1,dialogVisible:!1}),s=()=>{o.showAddDialog=!0},f=()=>{o.showAddDialog=!1},r=()=>{o.dialogVisible=!1},g=()=>{o.dialogVisible=!0},a=D(()=>e.afterUpdateOhpm);return{...L(o),openAddDialog:s,closeAddDialog:f,handleClose:r,showHelp:g,updateFun:a}}}),se={class:"ohpm"},ae={class:"ohpm-title"},ne={class:"title"},le={class:"ohpmNum m-l-32 f-12-Light"},ie={class:"about-key"},de={class:"dialog-title font-M h-24 lh-24"},re={class:"m-b-8 f-14-200-000 l-00cc font-L lh-24"},pe={class:"m-b-8 f-14-200-000 l-00cc font-L lh-24",style:{"margin-left":"24px"}},ce={class:"m-b-8 f-14-200-000 l-00cc font-L lh-24"},me={class:"m-b-8 f-14-200-000 l-00cc font-L lh-24"},ue={class:"m-b-32 f-14-200-000 l-00cc font-L lh-24"};function he(e,o,s,f,r,g){const a=p("Button"),d=p("OhpmAddDialog"),t=p("OhpmItem"),u=p("el-dialog");return b(),y("div",se,[n("div",ae,[n("div",ne,[l(a,{class:"add-btn f-12-Light",text:e.$t("security.add"),onClick:e.openAddDialog,isPrimary:!0},null,8,["text","onClick"]),n("span",le,i(e.$t("security.ohpmNums"))+"："+i(e.ohpmList.length),1)]),n("div",ie,[n("span",{class:"f-14-Medium pointer",onClick:o[0]||(o[0]=(...c)=>e.showHelp&&e.showHelp(...c))},i(e.$t("security.addKeys")),1)])]),l(d,{visible:e.showAddDialog,onOnClose:e.closeAddDialog,afterUpdateOhpm:e.updateFun},null,8,["visible","onOnClose","afterUpdateOhpm"]),l(t,{ohpmList:e.ohpmList,class:"m-t-16",afterUpdateOhpm:e.updateFun,ohpmLoading:e.ohpmLoading},null,8,["ohpmList","afterUpdateOhpm","ohpmLoading"]),l(u,{class:"tips-dialog","close-on-click-modal":!1,modelValue:e.dialogVisible,"onUpdate:modelValue":o[1]||(o[1]=c=>e.dialogVisible=c),width:"640px","before-close":e.handleClose},{header:m(()=>[n("div",de,i(e.$t("head.notes")),1)]),default:m(()=>[n("div",null,[n("div",re,i(e.$t("security.ohpmHelpOne")),1),n("div",pe,i(e.$t("security.ohpmHelpOneTip")),1),n("div",ce,i(e.$t("security.ohpmHelpTwo")),1),n("div",me,i(e.$t("security.ohpmHelpThree")),1),n("div",ue,i(e.$t("security.ohpmHelpFour")),1)])]),_:1},8,["modelValue","before-close"])])}const fe=T(te,[["render",he],["__scopeId","data-v-bb293a43"]]),ge=e=>v.post(`/api/access-token/${e}`).then(o=>o.data),be=e=>v.get("/api/access-token/list",{params:e}).then(o=>o.data),_e=e=>v.delete(`/api/access-token/${e}`).then(o=>o.data);const $e=C({props:{tokenList:Array,ohpmLoading:Boolean,afterUpdateToken:Function,tokenType:Object},components:{Pagination:H,ConfirmDialog:F},setup(e){const o=A().appContext.config.globalProperties,s=w({headStyle:{background:"#F5F5F5",color:"#000000"},headRowStyle:{height:"40px"},dialogVisible:!1,confirmTitle:"",tokenId:"",readType:1,readWriteType:2}),f=t=>{s.tokenId=t.id,s.confirmTitle=t.token,s.dialogVisible=!0},r=()=>{s.id="",s.dialogVisible=!1},g=()=>{_e(s.tokenId).then(t=>{t.code===200?(_.success(o.$t("accessToken.tokenDeleteSuccess")),e.afterUpdateToken()):_.error(t.message)}).finally(()=>r())},a=t=>P(t,"YYYY-MM-DD hh:mm:ss"),d=D(()=>o.$t("tree.noData"));return{...L(s),noData:d,showConfirmDialog:f,handleClose:r,handleDeleteConfirm:g,timeFormat:a}}}),ye={class:"access-token-table"},ke=["onClick"];function ve(e,o,s,f,r,g){const a=p("el-table-column"),d=p("el-tag"),t=p("el-table"),u=p("ConfirmDialog"),c=M("loading");return b(),y("div",ye,[U((b(),$(t,{data:e.tokenList,"header-cell-style":e.headStyle,"header-row-style":e.headRowStyle,"empty-text":e.noData},{default:m(()=>[l(a,{prop:"token","show-overflow-tooltip":"",label:e.$t("accessToken.token")},null,8,["label"]),l(a,{prop:"type","show-overflow-tooltip":"",label:e.$t("accessToken.type")},{default:m(h=>[h.row.type===e.tokenType.read?(b(),$(d,{key:0},{default:m(()=>[k(i(e.$t("accessToken.readType")),1)]),_:1})):h.row.type===e.tokenType.readWrite?(b(),$(d,{key:1},{default:m(()=>[k(i(e.$t("accessToken.readWriteType")),1)]),_:1})):V("",!0)]),_:1},8,["label"]),l(a,{prop:"createTime","show-overflow-tooltip":"",label:e.$t("accessToken.createTime")},{default:m(h=>[k(i(e.timeFormat(h.row.createTime)),1)]),_:1},8,["label"]),l(a,{fixed:"right","show-overflow-tooltip":"",label:e.$t("notification.operate"),width:"100"},{default:m(h=>[n("span",{class:"pointer",onClick:S=>e.showConfirmDialog(h.row)},i(e.$t("notification.delete")),9,ke)]),_:1},8,["label"])]),_:1},8,["data","header-cell-style","header-row-style","empty-text"])),[[c,e.ohpmLoading]]),l(u,{visible:e.dialogVisible,title:e.$t("notification.confirmTitle",{name:e.confirmTitle}),buttonStyle:!0,onOnClose:e.handleClose,onOnConfirm:e.handleDeleteConfirm},null,8,["visible","title","onOnClose","onOnConfirm"])])}const Te=T($e,[["render",ve],["__scopeId","data-v-1fddf846"]]);const Ce=C({components:{Pagination:H,AccessTokenItem:Te,Button:z,ConfirmDialog:F},setup(){const e=w({dialogVisible:!1,ohpmLoading:!1,tokenList:[],currentPage:1,pageSize:10,totalSize:0,tokenType:{read:1,readWrite:2}}),o=d=>{e.currentPage=d,s()},s=()=>{const d={pageSize:e.pageSize,currentPage:e.currentPage};be(d).then(t=>{if(t.code===200){const{total:u,data:c}=t.data;e.tokenList=c,e.totalSize=u}else _.error(t.message)})},f=()=>{e.dialogVisible=!0},r=()=>{e.dialogVisible=!1},g=d=>{ge(d).then(t=>{if(t.code===200){let u=document.createElement("input");u.value=t.data,document.body.appendChild(u),u.select(),document.execCommand("Copy"),_.success(`生成token成功，token已复制进剪切板:${t.data}`),u.remove(),s()}else _.error(t.message)})},a=()=>{e.dialogVisible=!0};return B(()=>{s()}),{...L(e),openAddDialog:f,handleClose:r,generate:g,showHelp:a,handleCurrentChange:o,getTokenList:s}}}),we={class:"ohpm"},Le={class:"ohpm-title"},Ve={class:"title"},De={class:"about-key"},Oe={class:"dialog-title font-M h-24 lh-24"},Ae={class:"m-b-8 f-14-200-000 l-00cc font-L lh-24"},Me={class:"m-b-8 f-14-200-000 l-00cc font-L lh-24"},Ue={class:"m-b-8 f-14-200-000 l-00cc font-L lh-24"},Fe={class:"m-b-4 f-14-200-000 l-00cc font-L lh-24"},Se={class:"m-b-4 f-14-200-000 l-00cc font-L lh-24",style:{"margin-left":"24px"}},Ie={class:"m-b-4 f-14-200-000 l-00cc font-L lh-24",style:{"margin-left":"24px"}},Pe={class:"m-b-32 f-14-200-000 l-00cc font-L lh-24",style:{"margin-left":"24px"}};function Be(e,o,s,f,r,g){const a=p("Button"),d=p("AccessTokenItem"),t=p("Pagination"),u=p("el-dialog");return b(),y("div",we,[n("div",Le,[n("div",Ve,[l(a,{class:"add-btn f-12-Light m-r-16",text:e.$t("accessToken.generateReadType"),onClick:o[0]||(o[0]=c=>e.generate(e.tokenType.read)),isPrimary:!0},null,8,["text"]),l(a,{class:"add-btn f-12-Light",text:e.$t("accessToken.generateReadWriteType"),onClick:o[1]||(o[1]=c=>e.generate(e.tokenType.readWrite)),isPrimary:!0},null,8,["text"])]),n("div",De,[n("span",{class:"f-14-Medium pointer",onClick:o[2]||(o[2]=(...c)=>e.showHelp&&e.showHelp(...c))},i(e.$t("accessToken.usageGuide")),1)])]),l(d,{class:"m-t-16",tokenList:e.tokenList,afterUpdateToken:e.getTokenList,ohpmLoading:e.ohpmLoading,tokenType:e.tokenType},null,8,["tokenList","afterUpdateToken","ohpmLoading","tokenType"]),e.totalSize>0?(b(),$(t,{key:0,handleCurrentChange:e.handleCurrentChange,"current-page":e.currentPage,total:e.totalSize,"page-size":e.pageSize},null,8,["handleCurrentChange","current-page","total","page-size"])):V("",!0),l(u,{class:"tips-dialog","close-on-click-modal":!1,modelValue:e.dialogVisible,"onUpdate:modelValue":o[3]||(o[3]=c=>e.dialogVisible=c),width:"640px","before-close":e.handleClose},{header:m(()=>[n("div",Oe,i(e.$t("head.notes")),1)]),default:m(()=>[n("div",null,[n("div",Ae,i(e.$t("accessToken.usageGuideOne")),1),n("div",Me,i(e.$t("accessToken.usageGuideTwo")),1),n("div",Ue,i(e.$t("accessToken.usageGuideThree")),1),n("div",Fe,i(e.$t("accessToken.usageGuideFour")),1),n("div",Se,i(e.$t("accessToken.usageGuideFour_One")),1),n("div",Ie,i(e.$t("accessToken.usageGuideFour_Two")),1),n("div",Pe,i(e.$t("accessToken.usageGuideFour_Three")),1)])]),_:1},8,["modelValue","before-close"])])}const ze=T(Ce,[["render",Be],["__scopeId","data-v-2869b446"]]);const He=C({components:{AccessToken:ze,Content:fe},setup(){const e=w({loading:!1,ohpmList:[],activeTab:"sshAuthentication"}),o=r=>{e.activeTab=r.name},s=()=>{e.loading=!0,K().then(r=>{r.code===200?(e.loading=!1,e.ohpmList=r.data.recordList.map(g=>new O(g))):_.error(r.message)}).finally(()=>e.loading=!1)},f=()=>{s()};return B(()=>{s()}),{...L(e),afterUpdateOhpm:f,handleClick:o}}}),Re={class:"person-tabs"},Ne={class:"tabs-head"},Ge={class:"tabs-content"},Ke={key:0,class:"ohpm"};function Ye(e,o,s,f,r,g){const a=p("el-tab-pane"),d=p("el-tabs"),t=p("Content"),u=p("AccessToken"),c=M("reset-tab-active-position");return b(),y("div",Re,[n("div",Ne,[U((b(),$(d,{modelValue:e.activeTab,"onUpdate:modelValue":o[0]||(o[0]=h=>e.activeTab=h),class:"tabs-wrapper"},{default:m(()=>[l(a,{label:e.$t("security.tabsTitle"),name:"sshAuthentication"},null,8,["label"]),l(a,{label:e.$t("accessToken.tabsTitle"),name:"AccessToken"},null,8,["label"])]),_:1},8,["modelValue"])),[[c]])]),n("div",Ge,[e.activeTab==="sshAuthentication"?(b(),y("div",Ke,[l(t,{ohpmList:e.ohpmList,afterUpdateOhpm:e.afterUpdateOhpm,ohpmLoading:e.loading},null,8,["ohpmList","afterUpdateOhpm","ohpmLoading"])])):V("",!0),e.activeTab==="AccessToken"?(b(),$(u,{key:1})):V("",!0)])])}const To=T(He,[["render",Ye],["__scopeId","data-v-b6bdb24b"]]);export{To as default};
