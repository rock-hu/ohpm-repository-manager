"use strict";var e=this&&this.__awaiter||function(e,i,n,t){return new(n||(n=Promise))((function(o,r){function c(e){try{d(t.next(e))}catch(e){r(e)}}function a(e){try{d(t.throw(e))}catch(e){r(e)}}function d(e){var i;e.done?o(e.value):(i=e.value,i instanceof n?i:new n((function(e){e(i)}))).then(c,a)}d((t=t.apply(e,i||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.initSchedule=void 0;const i=require("./initDbCacheSchedule"),n=require("../../packages/config/config"),t=require("../adminAuditLog/AdminAuditLogService"),o=require("../../packages/log"),r=require("../client/install/InstallService"),c=require("../../utils/CommonConstants");exports.initSchedule=function(){return e(this,void 0,void 0,(function*(){yield(0,i.initDbCacheSchedule)(),yield function(){return e(this,void 0,void 0,(function*(){setInterval((()=>e(this,void 0,void 0,(function*(){const e=Date.now()-n.config.operation_log_retention*c.NUMBER_OF_MILLIS_IN_DAY;yield t.adminAuditLogService.deleteExpiredOperationLogs(0,e),o.OhpmLazyLogger.debug(`delete expired operation logs: current operation log retention is "${n.config.operation_log_retention}" day.`)}))),c.NUMBER_OF_MILLIS_IN_DAY)}))}(),yield function(){return e(this,void 0,void 0,(function*(){setInterval((()=>e(this,void 0,void 0,(function*(){const e=Date.now()-c.NUMBER_OF_DAY_IN_YEAR*c.NUMBER_OF_MILLIS_IN_DAY,i=r.InstallService.getInstance();yield i.deleteExpiredDownloadPackageInfo(0,e),o.OhpmLazyLogger.debug(`delete expired dpwnloadPackage info: current downloadPackage info retention is "${c.NUMBER_OF_DAY_IN_YEAR}" day.`)}))),c.NUMBER_OF_MILLIS_IN_DAY)}))}()}))};