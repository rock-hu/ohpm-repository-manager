"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InjectValidator=void 0;const s=require("./Constants");class e{static isInvalid(e,t){let a;e===s.Constants.SQL_INJECT&&(a=this.SQL_RULE_ARRAY),e===s.Constants.XSS_INJECT&&(a=this.XSS_RULE_ARRAY);for(const s of a)if(s.test(t))return!0;return!1}}exports.InjectValidator=e,e.SQL_RULE_ARRAY=[/\/\*!?|\*\/|[';]--|--[\s\r\n\v\f]|(?:--[^-]*?-)|([^\-&])#.*?[\s\r\n\v\f]|;?\x00/,/(?:(?:\A|[^\d])0x[a-f\d]{3,}[a-f\d]*)/i,/(^["'`′’‘;]+|["'`′’‘;]+$)/,/(!=|&&|\|\||>>|<<|>=|<=|<>|<=>|xor|rlike|regexp|isnull)|(?:not\s+between\s+0\s+and)|(?:is\s+null)|(like\s+null)|(?:(?:^|\W)in[+\s]*\([\s\d"]+[^()]*\))|(?:xor|<>|rlike(?:\s+binary)?)|(?:regexp\s+binary)/i,/([\s'"`′’‘()]*?)\b([\d\w]+)([\s'"`′’‘()]*?)(?:(?:=|<=>|r?like|sounds\s+like|regexp)([\s'"`′’‘()]*?)\u0002\b|(?:!=|<=|>=|<>|<|>|\^|is\s+not|not\s+like|not\s+regexp)([\s'"`′’‘()]*?)(?!\u0002)([\d\w]+)\b)/i,/(m(?:s(?:ysaccessobjects|ysaces|ysobjects|ysqueries|ysrelationships|ysaccessstorage|ysaccessxml|ysmodules|ysmodules2|db)|aster\.\.sysdatabases|ysql\.db)|s(?:ys(?:\.database_name|aux)|chema(?:\W*\(|_name)|qlite(_temp)?_master)|d(?:atabas|b_nam)e\W*\(|information_schema|pg_(catalog|toast)|northwind|tempdb)/i],e.XSS_RULE_ARRAY=[/[<＜]script[^>＞]*[>＞][\s\S]*?/i,/[\s"'`;\/0-9=\x0B\x09\x0C\x3B\x2C\x28\x3B]+on[a-zA-Z]+[\s\x0B\x09\x0C\x3B\x2C\x28\x3B]*?=/i,/(?:<(?:(?:apple|objec)t|isindex|embed|style|form|meta)\b[^>]*?>[\s\S]*?|(?:=|U\s*?R\s*?L\s*?\()\s*?[^>]*?\s*?S\s*?C\s*?R\s*?I\s*?P\s*?T\s*?:)/i,/[\s\S](?:x(?:link:href|html|mlns)|!ENTITY.*?SYSTEM|data:text\/html|pattern(?=.*?=)|formaction|\@import|base64)\b/i,/\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=/i];