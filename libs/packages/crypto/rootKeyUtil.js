"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.newInstance256=exports.RootKey=void 0;const t=require("./constants"),e=require("./commCryptUtil"),r=require("./pbkdf2Util"),o=require("./CommonUtil");class n{constructor(t){this.rootKey=null,this.rootKey=t}getRootKey(){return this.rootKey?new Int8Array(this.rootKey):this.rootKey}getRootKeyHex(){return this.rootKey?(0,e.byte2HexStr)(this.rootKey):null}}function s(n,s,i,y,l){let u=null;const c=(0,e.hexStr2Byte)(n),h=(0,e.hexStr2Byte)(s),K=(0,e.hexStr2Byte)(i);let x;if(x=(0,o.isValidStr)(y)?(0,e.hexStr2Byte)(y):y,x&&c&&h&&K){const n=(0,o.getMinValue)(c.length,h.length,K.length);if(function(r,o){return r>=t.KEY_MIN_VALID_LENGTH&&(0,e.isKeyLengthValid)(o)}(n,y)){const o=[];for(let t=0;t<n;t++)o.push(String(c[t]^h[t]^K[t]));const s=(0,r.encryptPBKDF2WithSHA256)(o.join(""),y,t.ROOT_KEY_ITERATION_COUNT,l);u=(0,e.hexStr2Byte)(s)}}return u}exports.RootKey=n,exports.newInstance256=function(e,r,o,i){const y=s(e,r,o,i,t.KEY_256BIT_SIZE);return new n(y)};